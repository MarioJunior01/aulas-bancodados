CREATE DATABASE db_SistemaFilmesCristo;

USE db_SistemaFilmesCristo;

CREATE TABLE tbSala
(
numero_sala INT,
descricao_sala VARCHAR(20),
capacidade INT,
CONSTRAINT pk_tbSala PRIMARY KEY(numero_Sala)
);

CREATE TABLE tbDiretor
(
codigo_diretor INT,
nome_diretor VARCHAR(20),
CONSTRAINT pk_tbDiretor PRIMARY KEY(codigo_diretor)
);

CREATE TABLE tbFilme
(
codigo_filme INT,
nome_filme VARCHAR(50),
ano_lancamento INT,
categoria_filme VARCHAR(20),
codigo_diretor INT,
CONSTRAINT pk_tbFilme PRIMARY KEY(codigo_filme),
CONSTRAINT fk_tbDiretortbFilme FOREIGN KEY(codigo_diretor) REFERENCES tbDiretor(codigo_diretor)
);

CREATE TABLE tbSalaFilme
(
numero_sala INT,
codigo_filme INT,
data_filme DATE,
horario TIME,
CONSTRAINT pk_tbSalaFilme PRIMARY KEY(numero_sala, codigo_filme, data_filme),
CONSTRAINT fk_tbSalatbSalaFilme FOREIGN KEY(numero_sala) REFERENCES tbSala(numero_sala),
CONSTRAINT fk_tbFilmetbSalaFilme FOREIGN KEY(codigo_filme) REFERENCES tbFilme(codigo_filme)
);


CREATE TABLE tbPremio
(
codigo_premio INT,
nome_premio VARCHAR(20),
ano_premiacao INT,
codigo_filme INT,
CONSTRAINT pk_tbPremio PRIMARY KEY(codigo_premio),
CONSTRAINT fk_tbFilmetbPremio FOREIGN KEY(codigo_filme) REFERENCES tbFilme(codigo_filme)
);

#Exercicio02
INSERT INTO tbSala(numero_sala, descricao_sala, capacidade)
value (1, 'Sala 1', 100);

INSERT INTO tbSala(numero_sala, descricao_sala, capacidade)
value (2, 'Sala 2', 200);

INSERT INTO tbSala(numero_sala, descricao_sala, capacidade)
value (3, 'Sala 3', 300);

INSERT INTO tbSala(numero_sala, descricao_sala, capacidade)
value (4, 'Sala 4', 400);

INSERT INTO tbSala(numero_sala, descricao_sala, capacidade)
value (5, 'Sala 5', 500);

INSERT INTO tbDiretor(codigo_diretor, nome_diretor)
VALUE (1, 'Heber');

INSERT INTO tbDiretor(codigo_diretor, nome_diretor)
VALUE (2, 'Julio');

INSERT INTO tbDiretor(codigo_diretor, nome_diretor)
VALUE (3, 'Heitor');

INSERT INTO tbDiretor(codigo_diretor, nome_diretor)
VALUE (4, 'Lino');

INSERT INTO tbDiretor(codigo_diretor, nome_diretor)
VALUE (5, 'Edwin');

INSERT INTO tbFilme(codigo_filme, nome_filme, ano_lancamento, categoria_filme, codigo_diretor)
VALUE (1, 'Heber Filme', 2008, 'drama', 1);

INSERT INTO tbFilme(codigo_filme, nome_filme, ano_lancamento, categoria_filme, codigo_diretor)
VALUE (2, 'Julio Filme', 2007, 'Terror', 2);

INSERT INTO tbFilme(codigo_filme, nome_filme, ano_lancamento, categoria_filme, codigo_diretor)
VALUE (3, 'Heitor Filme', 2009, 'Comedia', 3);

INSERT INTO tbFilme(codigo_filme, nome_filme, ano_lancamento, categoria_filme, codigo_diretor)
VALUE (4, 'Lino Filme', 2010, 'Romance', 4);

INSERT INTO tbFilme(codigo_filme, nome_filme, ano_lancamento, categoria_filme, codigo_diretor)
VALUE (5, 'Edwin Filme', 2025, 'Esporte', 5);

INSERT INTO tbSalaFilme(numero_sala, codigo_filme, data_filme, horario)
VALUE (1, 1, '2024-05-06', '13:15:00');

INSERT INTO tbSalaFilme(numero_sala, codigo_filme, data_filme, horario)
VALUE (2, 2, '2024-05-06', '13:15:00');

INSERT INTO tbSalaFilme(numero_sala, codigo_filme, data_filme, horario)
VALUE (3, 3, '2024-05-06', '13:15:00');

INSERT INTO tbSalaFilme(numero_sala, codigo_filme, data_filme, horario)
VALUE (4, 4, '2024-05-06', '13:15:00');

INSERT INTO tbSalaFilme(numero_sala, codigo_filme, data_filme, horario)
VALUE (5, 5, '2024-05-06', '13:15:00');

INSERT INTO tbPremio(codigo_premio, nome_premio, ano_premiacao, codigo_filme)
VALUE (1, 'Heber premio', '2010', '1');

INSERT INTO tbPremio(codigo_premio, nome_premio, ano_premiacao, codigo_filme)
VALUE (2, 'Julio premio', '2011', '2');

INSERT INTO tbPremio(codigo_premio, nome_premio, ano_premiacao, codigo_filme)
VALUE (3, 'Heitor premio', '2012', '3');

INSERT INTO tbPremio(codigo_premio, nome_premio, ano_premiacao, codigo_filme)
VALUE (4, 'Lino premio', '2014', '4');

INSERT INTO tbPremio(codigo_premio, nome_premio, ano_premiacao, codigo_filme)
VALUE (5, 'Edwin premio', '2015', '5');

#Exercicio03
SELECT tbDiretor.nome_diretor
FROM tbDiretor;

#Exercicio04
SELECT tbFilme.nome_filme 
FROM tbFilme
WHERE categoria_filme = 'Terror';

#Exercicio05
UPDATE tbSala
SET capacidade = 200
WHERE numero_sala = 1;

#Exercicio06
UPDATE tbSalaFilme 
SET numero_sala = 1
WHERE numero_sala = 2 AND data_filme = '2024-05-06';

#Exercicio07
DELETE FROM tbPremio
WHERE codigo_filme  IN
        (SELECT tbFilme.codigo_filme
    FROM tbFilme INNER JOIN tbDiretor
                ON tbFilme.codigo_diretor = tbDiretor.codigo_diretor
        WHERE tbDiretor.nome_diretor = 'Edwin'
    );

DELETE FROM tbSalaFilme
WHERE codigo_filme IN
        (SELECT tbFilme.codigo_filme
        FROM tbFilme INNER JOIN tbDiretor
                        ON tbFilme.codigo_diretor = tbDiretor.codigo_diretor
                WHERE tbDiretor.nome_diretor = 'Edwin'
        );

DELETE FROM tbFilme
WHERE codigo_diretor =
                (SELECT tbDiretor.codigo_diretor
                        FROM tbDiretor
                        WHERE tbDiretor.nome_diretor = 'Edwin'
                );

DELETE FROM tbDiretor
WHERE tbDiretor.nome_diretor = 'Edwin';

#Exercicio08
SELECT tbFilme.nome_filme
FROM tbFilme INNER JOIN tbDiretor
ON tbFilme.codigo_diretor = tbDiretor.codigo_diretor 
WHERE tbDiretor.nome_diretor = 'Lino';

#Exercicio09
SELECT tbFilme.nome_filme, tbSalaFilme.horario
FROM tbFilme INNER JOIN tbSalaFilme
ON tbFilme.codigo_filme = tbSalaFilme.codigo_filme
WHERE tbSaLaFilme.data_filme = '2024-05-06';

#Exercicio10
SELECT tbPremio.*
FROM tbPremio INNER JOIN tbFilme 
ON tbPremio.codigo_filme = tbFilme.codigo_filme
WHERE tbFilme.nome_filme = 'Heber filme';

#Exercicio11
SELECT tbFilme.nome_filme
FROM tbFilme INNER JOIN tbSalaFilme
ON tbFilme.codigo_filme = tbSalaFilme.codigo_filme
INNER JOIN tbSala 
ON tbSalaFilme.numero_sala = tbSala.numero_sala
WHERE tbSala.capacidade = 200;

#Exercicio12
SELECT tbFilme.nome_filme
FROM tbFilme INNER JOIN tbSalaFilme
ON tbFilme.codigo_filme = tbSalaFilme.codigo_filme
WHERE tbSalaFilme.data_filme BETWEEN '2024-05-01' AND '2024-05-31';

#Exercicio13
SELECT tbFilme.nome_filme
FROM tbFilme INNER JOIN tbPremio 
ON tbFilme.codigo_filme = tbPremio.codigo_filme
WHERE tbPremio.nome_premio = 'Heber premio' AND tbPremio.ano_premiacao BETWEEN 2007 AND 2010;

#Exercicio14
SELECT tbFilme.nome_filme
FROM tbFilme INNER JOIN tbSalaFilme 
ON tbFilme.codigo_filme = tbSalaFilme.codigo_filme
WHERE tbFilme.categoria_filme = 'Comedia' AND tbSalaFilme.data_filme BETWEEN '2010-06-01' AND '2010-06-31';

#Exercicio15
SELECT tbSala.descricao_sala, tbFilme.categoria_filme, tbFilme.nome_filme
FROM tbFilme INNER JOIN tbDiretor 
ON tbFilme.codigo_diretor = tbDiretor.codigo_diretor
INNER JOIN tbSalaFilme 
ON tbFilme.codigo_filme = tbSalaFilme.codigo_filme
INNER JOIN tbSala 
ON tbSalaFilme.numero_sala = tbSala.numero_sala
WHERE tbDiretor.nome_diretor = 'Heber';